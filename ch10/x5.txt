See comments in x4.cpp
